# 多TSV文本数据万用查分系统

这是一个基于ASP的单文件自适应页面系统，用于查询TSV格式的文本数据文件。

## 功能特点

- **单文件部署**：所有功能集成在一个ASP文件中，无需额外依赖
- **自适应设计**：支持PC和移动端访问
- **多数据源**：支持多个TSV数据文件
- **灵活查询**：支持多条件精准查询
- **安全防护**：内置验证码和文件保护机制
- **数据展示**：支持横向/竖向表格切换
- **分页功能**：大数据量自动分页显示
- **特殊字段**：支持图片预览和链接跳转

## 文件结构

```
/
├── index.asp          # 主程序文件
├── shujuku/           # 数据文件夹
│   ├── 学生信息.xls.php
│   ├── 员工信息.xls.php
│   └── 商品信息.xls.php
└── README.md          # 说明文档
```

## 配置说明

在`index.asp`文件顶部可以修改以下配置：

```asp
title = "多输入框都输对精准查询系统(万用查分)"  ' 页面标题
copyr = "查立得-"                              ' 版权信息
jscss = "V20210909"                           ' 缓存版本号
ismas = "1"                                   ' 是否启用验证码(1启用/0禁用)
baoha = "1"                                   ' 是否精准查询(1启用/0禁用)
itiao = "||姓名||学号||工号||"                ' 查询条件字段
ihide = "||密码||身份证||身份证号||身份证号码||" ' 隐藏字段
isurl = "||购买地址||先领优惠券||领券地址||网址的列标题||" ' URL字段
isimg = "||商品主图||产品图片||"              ' 图片字段
dbdir = "./shujuku/"                          ' 数据文件夹路径
dbxls = ".xls.php"                            ' 数据文件后缀
pagex = "10"                                  ' 每页显示条数
pagem = "20"                                  ' 最大页数限制
```

## 数据文件格式

数据文件必须是TSV格式（制表符分隔），文件结构：

1. **第一行**：PHP保护代码（防止直接下载）
2. **第二行**：空行或注释
3. **第三行**：字段标题（制表符分隔）
4. **第四行开始**：数据行（制表符分隔）

示例：
```
<?php
// 防止直接下载数据文件
if (!isset($_GET['do']) || $_GET['do'] !== 'data') {
    header('HTTP/1.1 403 Forbidden');
    exit('Access Denied');
}
?>
姓名	学号	班级	专业	电话	邮箱	身份证	密码
张三	2021001	计算机1班	计算机科学与技术	13800138001	zhangsan@example.com	110101199001011234	123456
李四	2021002	计算机1班	计算机科学与技术	13800138002	lisi@example.com	110101199002021234	123456
```

## 使用方法

1. **部署文件**：将`index.asp`上传到支持ASP的服务器
2. **创建数据文件夹**：在服务器上创建`shujuku`文件夹
3. **添加数据文件**：将TSV数据文件放入`shujuku`文件夹，文件名为`数据名.xls.php`
4. **配置字段**：根据数据文件修改`index.asp`中的字段配置
5. **访问系统**：通过浏览器访问`index.asp`

## 功能说明

### 查询功能
- 选择数据文件后自动显示查询条件
- 支持多条件同时查询
- 所有条件必须完全匹配（精准查询）
- 支持验证码验证（可配置）

### 结果显示
- 横向表格：传统表格显示方式
- 竖向表格：每行数据垂直显示
- 支持图片点击预览
- 支持链接点击跳转
- 自动分页显示

### 安全特性
- 数据文件PHP保护，防止直接下载
- 验证码防刷机制
- 分页限制防止数据泄露
- 敏感字段自动隐藏

## 技术特点

- **前端**：HTML5 + CSS3 + JavaScript + AJAX
- **后端**：ASP (VBScript)
- **数据格式**：TSV (制表符分隔值)
- **响应式设计**：支持各种屏幕尺寸
- **无依赖**：不依赖任何第三方库

## 注意事项

1. 确保服务器支持ASP和VBScript
2. 数据文件必须使用UTF-8编码
3. 字段配置中的`||`分隔符必须正确
4. 图片和链接字段需要完整的URL路径
5. 建议定期备份数据文件

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+
- IE 11+（部分功能可能受限）

## 更新日志

- V20210909：初始版本，支持基本查询和显示功能