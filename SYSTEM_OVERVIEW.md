# 多TSV文本数据万用查分系统 - 系统概览

## 系统简介

这是一个基于ASP的单文件自适应页面系统，专门用于查询TSV格式的文本数据文件。系统采用原生HTML5+CSS3+JavaScript+AJAX技术，无需任何第三方依赖，具有高度的可移植性和易用性。

## 核心特性

### 🎯 精准查询
- 支持多条件同时查询
- 所有条件必须完全匹配（精准查询模式）
- 支持模糊查询和精确查询切换

### 🔒 安全防护
- 内置4位数字验证码防刷机制
- 数据文件PHP保护，防止直接下载
- 敏感字段自动隐藏显示
- 分页限制防止数据泄露

### 📱 响应式设计
- 支持PC和移动端访问
- Flex布局自适应各种屏幕尺寸
- 现代化UI设计，用户体验优良

### 📊 灵活展示
- 横向表格：传统表格显示方式
- 竖向表格：每行数据垂直显示
- 支持图片点击预览（全屏模态框）
- 支持链接点击跳转（安全提示）

### 🔧 高度可配置
- 查询字段可自定义配置
- 隐藏字段可自定义配置
- URL字段和图片字段可自定义
- 分页大小和最大页数可调整

## 技术架构

### 前端技术
- **HTML5**：语义化标签，现代化结构
- **CSS3**：Flex布局，渐变背景，响应式设计
- **JavaScript ES6+**：模块化编程，异步处理
- **AJAX**：无刷新数据交互

### 后端技术
- **ASP (VBScript)**：服务器端脚本处理
- **文件系统**：TSV文件读写操作
- **Session**：验证码状态管理
- **JSON**：数据交换格式

### 数据格式
- **TSV**：制表符分隔值文件
- **UTF-8**：统一字符编码
- **PHP保护**：防止直接访问

## 文件结构

```
/
├── index.asp              # 主程序文件（单文件架构）
├── shujuku/              # 数据文件夹
│   ├── 学生信息.xls.php   # 学生数据示例
│   ├── 员工信息.xls.php   # 员工数据示例
│   ├── 商品信息.xls.php   # 商品数据示例
│   └── 产品目录.xls.php   # 产品数据示例
├── test.html             # 功能测试页面
├── README.md             # 使用说明
├── DEPLOY.md             # 部署指南
└── SYSTEM_OVERVIEW.md    # 系统概览（本文件）
```

## 功能模块

### 1. 文件管理模块
- **文件列表获取**：自动扫描数据文件夹
- **字段解析**：自动解析TSV文件字段
- **动态表单**：根据字段生成查询表单

### 2. 查询处理模块
- **条件验证**：检查所有查询条件是否填写
- **验证码验证**：4位数字验证码校验
- **数据匹配**：逐行对比查询条件
- **结果格式化**：JSON格式数据返回

### 3. 结果展示模块
- **表格渲染**：动态生成HTML表格
- **视图切换**：横向/竖向表格切换
- **分页处理**：大数据量自动分页
- **特殊字段**：图片预览和链接跳转

### 4. 安全防护模块
- **文件保护**：PHP代码防止直接下载
- **验证码机制**：防止恶意查询
- **权限控制**：敏感字段隐藏
- **输入验证**：防止SQL注入等攻击

## 配置参数

### 基本配置
```asp
title = "多输入框都输对精准查询系统(万用查分)"  ' 页面标题
copyr = "查立得-"                              ' 版权信息
jscss = "V20210909"                           ' 缓存版本号
```

### 功能配置
```asp
ismas = "1"    ' 验证码：1启用/0禁用
baoha = "1"    ' 精准查询：1启用/0禁用
```

### 字段配置
```asp
itiao = "||姓名||学号||工号||产品名称||产品编号||"                    ' 查询条件字段
ihide = "||密码||身份证||身份证号||身份证号码||"                       ' 隐藏字段
isurl = "||购买地址||先领优惠券||领券地址||网址的列标题||优惠券地址||"   ' URL字段
isimg = "||商品主图||产品图片||"                                      ' 图片字段
```

### 系统配置
```asp
dbdir = "./shujuku/"    ' 数据文件夹路径
dbxls = ".xls.php"      ' 数据文件后缀
pagex = "10"            ' 每页显示条数
pagem = "20"            ' 最大页数限制
```

## 使用流程

### 1. 系统初始化
- 访问 `index.asp` 页面
- 系统自动加载文件列表
- 显示第一个文件的查询条件

### 2. 数据查询
- 选择要查询的数据文件
- 填写相应的查询条件
- 输入验证码（如果启用）
- 点击查询按钮

### 3. 结果展示
- 系统返回JSON格式查询结果
- 自动生成表格显示数据
- 支持横向/竖向视图切换
- 支持分页浏览

### 4. 特殊功能
- 点击图片可全屏预览
- 点击链接可安全跳转
- 支持结果导出和打印

## 性能特点

### 优势
- **单文件部署**：无需复杂安装配置
- **无依赖运行**：不依赖任何第三方库
- **轻量级设计**：代码简洁，运行高效
- **跨平台兼容**：支持各种Web服务器

### 限制
- **数据量限制**：适合中小型数据集
- **并发限制**：文件锁可能影响并发访问
- **功能限制**：相比数据库系统功能较简单

## 适用场景

### 教育机构
- 学生信息查询系统
- 成绩查询系统
- 课程信息查询

### 企业应用
- 员工信息查询
- 产品目录查询
- 客户信息管理

### 个人项目
- 个人数据管理
- 小型网站数据查询
- 原型系统开发

## 扩展建议

### 功能扩展
- 添加数据导入导出功能
- 支持更多数据格式（CSV、Excel等）
- 添加数据统计和分析功能
- 支持用户权限管理

### 性能优化
- 实现数据缓存机制
- 添加数据库支持选项
- 优化大数据量查询性能
- 实现异步查询处理

### 安全增强
- 添加用户登录验证
- 实现操作日志记录
- 加强输入数据验证
- 添加HTTPS支持

## 维护建议

### 日常维护
- 定期备份数据文件
- 监控系统访问日志
- 检查文件权限设置
- 更新安全补丁

### 性能监控
- 监控查询响应时间
- 检查内存使用情况
- 分析用户访问模式
- 优化查询性能

### 安全维护
- 定期更新验证码机制
- 检查文件访问权限
- 监控异常访问行为
- 备份重要数据文件

## 技术支持

如需技术支持或功能定制，请参考：
- `README.md` - 详细使用说明
- `DEPLOY.md` - 部署配置指南
- `test.html` - 功能测试页面

系统采用开源架构，代码简洁易懂，便于二次开发和功能扩展。