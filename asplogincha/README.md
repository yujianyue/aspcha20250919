# 通用工资查询系统 2025版

## 系统简介

通用工资查询系统是一个基于ASP+Access的Web应用程序，专为工资数据查询和管理而设计。系统采用现代化的响应式界面，支持手机和电脑访问，提供完整的用户管理、工资数据管理和查询功能。

## 环境要求

- **服务器环境**: IIS + ASP
- **数据库**: Microsoft Access (.mdb)
- **编码格式**: GB2312
- **浏览器支持**: Chrome, Firefox, Safari, Edge (现代浏览器)
- **移动端支持**: 响应式设计，支持手机和平板访问

## 默认账户和密码

### 管理员账户
- **用户名**: admin
- **密码**: admin123

### 普通用户
- 通过管理员后台添加用户
- 或使用安装时导入的示例数据（user1-user30，密码均为hello）

## 文件结构

```
asplogincha/
├── inc/                    # 公共文件目录
│   ├── conn.asp           # 数据库连接配置
│   ├── pubs.asp           # 公共函数库
│   ├── sqls.asp           # 数据库操作类
│   ├── css.css            # 样式文件
│   └── js.js              # JavaScript公共函数
├── install/               # 安装目录
│   └── index.asp          # 数据库安装页面
├── user/                  # 用户目录
│   └── index.asp          # 用户登录和查询页面
├── admin/                 # 管理员目录
│   ├── ihead.asp          # 公共头部
│   ├── ifoot.asp          # 公共底部
│   ├── login.asp          # 管理员登录
│   ├── index.asp          # 管理员首页
│   ├── ipass.asp          # 修改密码
│   ├── iuser.asp          # 用户管理
│   ├── isala.asp          # 工资管理
│   ├── iusin.asp          # 用户导入
│   ├── isain.asp          # 工资导入
│   ├── iview.asp          # 数据预览
│   ├── ibaks.asp          # 数据维护
│   └── idubi.asp          # 辅助工具
├── data/                  # 数据文件目录（自动创建）
├── backup/                # 备份文件目录（自动创建）
├── data.mdb              # 数据库文件（安装后生成）
├── index.asp             # 主页面
└── README.md             # 说明文档
```

## 数据库结构

### 网站设置表 [conn]
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | 自增ID | 主键 |
| s_name | 文本(50) | 网站名称 |
| s_urls | 文本(255) | 底部链接 |
| s_tiao | 文本(100) | 查询条件 |
| s_isma | 是/否 | 登陆页是否验证码 |
| s_logs | 是/否 | 是否记录日志 |
| s_desc | 文本(255) | 登陆页说明 |
| s_chax | 文本(255) | 列表页面说明 |
| s_jies | 文本(255) | 无结果说明 |

### 用户表 [user]
| 字段名 | 类型 | 说明 |
|--------|------|------|
| user_id | 自增ID | 主键 |
| usertype | 文本(10) | 用户类型(admin/user) |
| username | 文本(50) | 用户名 |
| password | 文本(32) | 密码(MD5加密) |
| nickname | 文本(50) | 姓名 |
| check | 是/否 | 是否可登录 |

### 工资表 [data]
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | 自增ID | 主键 |
| timu | 文本(100) | 查询标题 |
| tiao | 文本(100) | 查询条件 |
| path | 文本(255) | 文件路径 |
| icha | 是/否 | 查询状态(1可查,0不可查) |
| add_time | 文本(8) | 添加日期(YYYYMMDD) |
| cha_note | 文本(255) | 查询备注 |

## 功能详细说明

### 1. 安装功能 (install/index.asp)
- **功能**: 数据库初始化安装
- **特点**: 
  - 自动创建数据表结构
  - 可选择导入示例数据（30条用户+30条工资数据）
  - 安装完成后可删除install文件夹
- **访问**: 首次访问系统时使用

### 2. 用户功能 (user/index.asp)
- **登录**: 用户名密码登录验证
- **密码修改**: 用户可自行修改密码
- **工资查询**: 查看分配给该用户的工资数据
- **数据预览**: 以表格形式显示工资详情

### 3. 管理员功能

#### 3.1 用户管理 (admin/iuser.asp)
- **用户列表**: 分页显示所有用户
- **添加用户**: 单个添加新用户
- **编辑用户**: 修改用户信息
- **删除用户**: 单个或批量删除用户
- **密码重置**: 管理员可重置用户密码
- **搜索功能**: 按用户名或姓名搜索

#### 3.2 工资管理 (admin/isala.asp)
- **工资列表**: 显示所有工资记录
- **编辑记录**: 修改工资记录信息
- **删除记录**: 单个或批量删除记录
- **状态管理**: 控制记录是否可查询
- **搜索功能**: 按标题或查询条件搜索

#### 3.3 用户导入 (admin/iusin.asp)
- **Excel粘贴**: 从Excel复制数据直接粘贴
- **格式验证**: 自动验证用户名密码格式（5-20位数字字母组合）
- **批量导入**: 一次性导入多个用户
- **错误提示**: 详细的导入结果和错误信息

#### 3.4 工资导入 (admin/isain.asp)
- **TXT方式**: 从Excel复制数据粘贴导入
- **XLS方式**: 上传Excel文件导入（需要服务器支持）
- **数据解析**: 自动解析工资数据并保存为JSON格式
- **文件管理**: 自动创建data目录并管理数据文件

#### 3.5 数据预览 (admin/iview.asp)
- **数据列表**: 显示所有工资数据记录
- **内容预览**: 查看具体的数据文件内容
- **分页显示**: 支持大量数据的分页浏览
- **搜索功能**: 按查询条件搜索数据

#### 3.6 数据维护 (admin/ibaks.asp)
- **数据库备份**: 一键备份当前数据库
- **历史记录**: 显示所有备份文件
- **文件下载**: 下载备份文件
- **数据恢复**: 从备份文件恢复数据库
- **文件管理**: 按时间排序显示备份历史

#### 3.7 辅助工具 (admin/idubi.asp)
- **用户对比**: 对比用户表和工资数据中的用户
- **独有用户**: 显示各自独有的用户
- **共同用户**: 显示两个数据源共同的用户
- **数据清理**: 帮助发现数据不一致问题

## 技术特点

### 1. 响应式设计
- 基于HTML5+CSS3的现代化界面
- 支持手机、平板、电脑多端访问
- 自适应布局，最佳用户体验

### 2. AJAX交互
- 所有操作均使用AJAX异步处理
- 无需页面刷新，操作流畅
- 实时反馈操作结果

### 3. 数据安全
- 密码MD5加密存储
- SQL注入防护
- 输入数据安全过滤

### 4. 分页功能
- 智能分页算法
- 支持大量数据展示
- 页码导航和跳转

### 5. 遮罩层设计
- 居中显示，自适应大小
- 右上角关闭按钮
- 防止内容溢出，支持滚动

## 安装步骤

1. **上传文件**: 将所有文件上传到Web服务器
2. **设置权限**: 确保IIS有读写权限
3. **访问安装**: 浏览器访问 `http://yourdomain.com/asplogincha/install/`
4. **执行安装**: 点击"安装数据库"按钮
5. **导入数据**: 可选择导入示例数据
6. **删除安装**: 安装完成后删除install文件夹
7. **开始使用**: 访问 `http://yourdomain.com/asplogincha/`

## 使用说明

### 管理员使用
1. 使用admin/admin123登录管理后台
2. 在"用户管理"中添加用户
3. 在"工资导入"中导入工资数据
4. 在"工资管理"中管理工资记录
5. 定期使用"数据维护"备份数据库

### 用户使用
1. 使用管理员分配的用户名密码登录
2. 查看分配给自己的工资数据
3. 点击"查看详情"查看具体工资信息
4. 可自行修改登录密码

## 注意事项

1. **编码格式**: 所有文件使用GB2312编码
2. **数据库路径**: 确保data.mdb文件路径正确
3. **文件权限**: 确保IIS有data和backup目录的读写权限
4. **备份重要**: 定期备份数据库文件
5. **安全设置**: 生产环境建议修改默认密码

## 版权声明

- **版权**: 保留发行权和署名权
- **作者**: 15058593138@qq.com
- **版本**: 2025版
- **技术支持**: 手机号同微信

## 更新日志

### v2025.1.0
- 初始版本发布
- 完整的用户管理和工资查询功能
- 响应式界面设计
- 数据导入导出功能
- 数据库备份恢复功能

---

**系统特点**: 简洁易用、功能完整、安全可靠、响应式设计
**适用场景**: 企业工资查询、学校工资管理、部门工资发放等