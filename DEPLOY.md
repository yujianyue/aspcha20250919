# 部署说明

## 系统要求

- **Web服务器**：IIS 7.0+ 或支持ASP的Web服务器
- **脚本引擎**：VBScript 5.6+
- **操作系统**：Windows Server 2008+ 或 Windows 10+
- **权限**：文件系统读写权限

## 部署步骤

### 1. 准备服务器环境

确保服务器已安装并配置：
- IIS (Internet Information Services)
- ASP功能已启用
- VBScript脚本引擎

### 2. 上传文件

将以下文件上传到Web服务器根目录：
```
/wwwroot/
├── index.asp          # 主程序文件
├── shujuku/           # 数据文件夹
│   ├── 学生信息.xls.php
│   ├── 员工信息.xls.php
│   └── 商品信息.xls.php
└── test.html          # 测试页面（可选）
```

### 3. 设置权限

确保Web服务器对以下目录有读写权限：
- `/` (根目录)
- `/shujuku/` (数据文件夹)

### 4. 配置IIS

1. 打开IIS管理器
2. 找到网站，右键选择"属性"
3. 在"主目录"选项卡中：
   - 确保"脚本资源访问"已勾选
   - 确保"读取"已勾选
   - 确保"写入"已勾选（用于数据文件）
4. 在"文档"选项卡中：
   - 添加 `index.asp` 为默认文档

### 5. 测试部署

1. 访问 `http://your-domain.com/test.html` 进行功能测试
2. 访问 `http://your-domain.com/index.asp` 使用系统

## 配置修改

### 基本配置

编辑 `index.asp` 文件顶部的配置参数：

```asp
' 页面配置
title = "多输入框都输对精准查询系统(万用查分)"
copyr = "查立得-"
jscss = "V20210909"

' 功能配置
ismas = "1"    ' 验证码：1启用/0禁用
baoha = "1"    ' 精准查询：1启用/0禁用

' 字段配置
itiao = "||姓名||学号||工号||"                    ' 查询条件字段
ihide = "||密码||身份证||身份证号||身份证号码||"   ' 隐藏字段
isurl = "||购买地址||先领优惠券||领券地址||"       ' URL字段
isimg = "||商品主图||产品图片||"                  ' 图片字段

' 系统配置
dbdir = "./shujuku/"    ' 数据文件夹
dbxls = ".xls.php"      ' 数据文件后缀
pagex = "10"            ' 每页显示条数
pagem = "20"            ' 最大页数限制
```

### 添加新数据文件

1. 创建TSV格式的数据文件
2. 文件命名为 `数据名.xls.php`
3. 文件结构：
   ```php
   <?php
   // 防止直接下载数据文件
   if (!isset($_GET['do']) || $_GET['do'] !== 'data') {
       header('HTTP/1.1 403 Forbidden');
       exit('Access Denied');
   }
   ?>
   字段1	字段2	字段3	字段4
   数据1	数据2	数据3	数据4
   数据5	数据6	数据7	数据8
   ```
4. 将文件放入 `shujuku` 文件夹
5. 根据字段名称更新配置参数

## 安全建议

1. **文件保护**：确保数据文件使用 `.xls.php` 后缀，防止直接下载
2. **权限控制**：限制对 `shujuku` 文件夹的直接访问
3. **验证码**：建议在生产环境中启用验证码功能
4. **数据备份**：定期备份数据文件
5. **访问日志**：监控系统访问日志

## 故障排除

### 常见问题

1. **500内部服务器错误**
   - 检查IIS是否支持ASP
   - 检查VBScript是否已安装
   - 检查文件权限设置

2. **文件列表为空**
   - 检查 `shujuku` 文件夹是否存在
   - 检查数据文件格式是否正确
   - 检查字段配置是否匹配

3. **查询无结果**
   - 检查查询条件字段配置
   - 检查数据文件编码格式
   - 检查验证码是否正确

4. **图片不显示**
   - 检查图片URL是否有效
   - 检查网络连接
   - 检查图片字段配置

### 调试方法

1. 使用 `test.html` 页面测试各项功能
2. 检查IIS错误日志
3. 在ASP代码中添加调试输出
4. 使用浏览器开发者工具查看网络请求

## 性能优化

1. **数据文件大小**：建议单个文件不超过10MB
2. **分页设置**：根据服务器性能调整每页显示条数
3. **缓存设置**：修改 `jscss` 参数强制更新缓存
4. **数据库索引**：对于大数据量，考虑使用数据库替代文件

## 维护建议

1. **定期备份**：每日备份数据文件
2. **日志监控**：监控系统访问和错误日志
3. **性能监控**：定期检查系统响应时间
4. **安全更新**：及时更新服务器安全补丁